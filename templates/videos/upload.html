{% extends 'base.html' %}
{% load static %}

{% block title %}비디오 업로드 - FaceBlur{% endblock %}

{% block main_class %}{% endblock %}

{% block content %}
<div class="relative flex h-auto min-h-screen w-full flex-col">
    <div class="flex h-full grow flex-col">
        <div class="flex flex-1 justify-center py-10 px-4 sm:px-6 lg:px-8">
            <div class="flex w-full max-w-3xl flex-col">

                <!-- 페이지 헤딩 -->
                <div class="flex flex-wrap justify-between gap-3 p-4">
                    <div class="flex min-w-72 flex-col gap-2">
                        <p class="text-4xl font-bold tracking-tight">비디오 업로드 및 처리</p>
                        <p class="text-secondary-light dark:text-secondary-dark text-base font-normal">
                            파일을 업로드하여 처리를 시작하세요
                        </p>
                    </div>
                </div>

                <!-- 업로드 영역 (드래그앤드롭) -->
                <div class="flex flex-col p-4">
                    <div id="drop-zone" class="flex flex-col items-center gap-6 rounded-xl border-2 border-dashed border-border-light dark:border-border-dark px-6 py-14 transition-colors hover:border-primary/80 hover:bg-primary/5 dark:hover:bg-primary/10 cursor-pointer">
                        <div class="flex flex-col items-center gap-2">
                            <span class="material-symbols-outlined text-5xl text-secondary-light dark:text-secondary-dark">cloud_upload</span>
                            <p class="text-lg font-bold">이곳에 비디오 파일을 드래그 앤 드롭하세요</p>
                            <p class="text-sm font-normal">또는</p>
                        </div>
                        <button type="button" id="select-file-btn" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-5 bg-primary text-white text-sm font-bold shadow-sm transition-colors hover:bg-primary/90">
                            <span class="truncate">컴퓨터에서 파일 선택</span>
                        </button>

                        <!-- 숨겨진 파일 입력 -->
                        <input type="file" id="video-file-input" accept="video/mp4,video/mov,video/avi,video/mkv" class="hidden" />
                    </div>
                    <p class="text-secondary-light dark:text-secondary-dark text-sm font-normal pt-3 text-center">
                        최대 파일 크기: 500MB, 지원 포맷: MP4, MOV, AVI, MKV
                    </p>
                </div>

                <!-- 구분선 -->
                <div class="my-4 border-t border-border-light dark:border-border-dark"></div>

                <!-- 업로드 진행 상황 섹션 (동적으로 표시) -->
                <div id="upload-progress-section" class="flex flex-col gap-8 p-4" style="display: none;">
                    <!-- 업로드 항목들이 JavaScript로 동적 추가됨 -->
                </div>

                <!-- 예시 상태 (개발 중 참고용 - 실제로는 숨김) -->
                {% comment %}
                <div class="flex flex-col gap-8 p-4">
                    <!-- 업로드 중 상태 -->
                    <div class="flex flex-col gap-3">
                        <div class="flex flex-wrap gap-2 justify-between">
                            <p class="text-base font-medium">example_video.mp4 (150MB)</p>
                            <p class="text-sm font-normal text-secondary-light dark:text-secondary-dark">55%</p>
                        </div>
                        <div class="w-full rounded-full bg-slate-200 dark:bg-border-dark">
                            <div class="h-2 rounded-full bg-primary" style="width: 55%;"></div>
                        </div>
                        <div class="flex items-center justify-between">
                            <p class="text-sm font-normal text-secondary-light dark:text-secondary-dark">업로드 중...</p>
                            <button class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-8 px-3 bg-transparent text-secondary-light dark:text-secondary-dark gap-1 text-sm font-bold transition-colors hover:bg-slate-100 dark:hover:bg-surface-dark">
                                <span class="material-symbols-outlined text-base">cancel</span>
                                <span class="truncate">취소</span>
                            </button>
                        </div>
                    </div>

                    <!-- 처리 중 상태 -->
                    <div class="flex flex-col gap-3">
                        <div class="flex flex-wrap gap-2 justify-between">
                            <p class="text-base font-medium">project_video.mov (1.2GB)</p>
                            <p class="text-sm font-normal text-secondary-light dark:text-secondary-dark">80%</p>
                        </div>
                        <div class="w-full rounded-full bg-slate-200 dark:bg-border-dark">
                            <div class="h-2 rounded-full bg-primary" style="width: 80%;"></div>
                        </div>
                        <p class="text-sm font-normal text-secondary-light dark:text-secondary-dark">얼굴 분석 중...</p>
                    </div>

                    <!-- 완료 상태 -->
                    <div class="flex flex-col gap-3">
                        <div class="flex items-center justify-between">
                            <p class="text-base font-medium">vacation_video.mp4 (450MB)</p>
                            <span class="material-symbols-outlined text-success">check_circle</span>
                        </div>
                        <p class="text-sm font-normal text-success">분석 완료! 얼굴 선택 단계로 이동하세요.</p>
                        <a href="#" class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-5 bg-primary text-white text-sm font-bold shadow-sm transition-colors hover:bg-primary/90">
                            <span class="truncate">다음 단계로</span>
                        </a>
                    </div>

                    <!-- 에러 상태 -->
                    <div class="flex flex-col gap-3">
                        <div class="flex items-center justify-between">
                            <p class="text-base font-medium">unsupported.wmv (25MB)</p>
                            <span class="material-symbols-outlined text-error">error</span>
                        </div>
                        <p class="text-sm font-normal text-error">지원하지 않는 파일 형식입니다.</p>
                    </div>
                </div>
                {% endcomment %}

            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/api.js' %}"></script>
<script src="{% static 'js/upload.js' %}"></script>
{% endblock %}
